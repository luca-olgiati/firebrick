<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>World WMS Example</title>
<link rel="stylesheet" href="../../libraries/OpenLayers-2.13.1/theme/default/style.css" type="text/css">

<script src="../../libraries/OpenLayers-2.13.1/OpenLayers.js"></script>

<!-- script src="http://openlayers.org/api/OpenLayers.js"></script -->

<!-- script src="../../libraries/OpenLayers/OpenLayers.debug.js"></script -->
<script src="../../libraries/proj4js/proj4js-combined.js"></script>
<script src="../../libraries/proj4js/defs/EPSG21781.js"></script>
<script src="../../libraries/proj4js/util/MGRS.js"></script>
<script src="../../libraries/jquery-2.1.0.min.js"></script>
<script src="../../scripts/RandomEtc-shapefile-js/lib/binaryajax.js"></script>
<script src="../../scripts/RandomEtc-shapefile-js/src/binarywrapper.js"></script>
<script src="../../scripts/RandomEtc-shapefile-js/src/shapefile.js"></script>
<script src="../../scripts/RandomEtc-shapefile-js/src/dbf.js"></script>
<script src="../../scripts/RandomEtc-shapefile-js/src/ol_shapefile.js"></script>

<script type="text/javascript">



// NEW



 var  map, drawControls, selectControl, selectedFeature;
        function onPopupClose(evt) {
            selectControl.unselect(selectedFeature);
        }
        function onFeatureSelect(feature) {
            selectedFeature = feature;
            popup = new OpenLayers.Popup.FramedCloud("chicken", 
                                     feature.geometry.getBounds().getCenterLonLat(),
                                     null,
                                     "<div style='font-size:.8em'>Feature: " + feature.id +"<br>Area: " + feature.geometry.getArea()+"</div>",
                                     null, true, onPopupClose);
            feature.popup = popup;
            map.addPopup(popup);
        }
        function onFeatureUnselect(feature) {
            map.removePopup(feature.popup);
            feature.popup.destroy();
            feature.popup = null;
        }    
		
		
		
//newend

			/** A convenient function that add vector layers to the map. 
		function addVectorLayer(map, name, url, opts) {
			var layer = new OpenLayers.Layer.Vector(name, opts);
			getOpenLayersFeatures(url, function(vectors) {
				if (opts.hilite) {
					geom = layer;
					for (var i = 0; i < vectors.length; ++i) {
						var vector = vectors[i];
						var nn = strip(vector.data.values.NAME);
						$('<li/>').attr('id', vector.id).text(nn).appendTo(ul);
					}
					// Sort the list
					var li = ul.children('li').get();
					li.sort(function(a, b) {
						return $(a).text().toUpperCase().localeCompare($(b).text().toUpperCase());
					})
					$.each(li, function(idx, itm) { ul.append(itm); });
					// Enable selection
					var control = new OpenLayers.Control.SelectFeature(layer, opts.hilite);
					select = control;
					map.addControl(control);
					control.activate();
				}
				for (var i = 0; i < vectors.length; ++i) {
					var vector = vectors[i];
					//vector.geometry.transform(srcProj, dstProj);
				}
				layer.addFeatures(vectors);
			});
			map.addLayer(layer);
		}
		*/
		/* A convenient function that add vector layers to the map. */
		function addVectorLayer(map, name, url, opts) {
			var layer = new OpenLayers.Layer.Vector(name, opts);
			getOpenLayersFeatures(url, function(vectors) {
				if (opts.hilite) {
					geom = layer;
					for (var i = 0; i < vectors.length; ++i) {
						var vector = vectors[i];
						var nn = strip(vector.data.values.NAME);
						$('<li/>').attr('id', vector.id).text(nn).appendTo(ul);
					}
					// Sort the list
					var li = ul.children('li').get();
					li.sort(function(a, b) {
						return $(a).text().toUpperCase().localeCompare($(b).text().toUpperCase());
					})
					$.each(li, function(idx, itm) { ul.append(itm); });
					// Enable selection
					var control = new OpenLayers.Control.SelectFeature(layer, opts.hilite);
					select = control;
					map.addControl(control);
					control.activate();
				}
				for (var i = 0; i < vectors.length; ++i) {
					var vector = vectors[i];
					//vector.geometry.transform(srcProj, dstProj);
				}
				layer.addFeatures(vectors);
			});
			//map.addLayer(layer);
			return layer;
		}


function init() {
	OpenLayers.IMAGE_RELOAD_ATTEMPTS = 3; 
	OpenLayers.Util.onImageLoadErrorColor = "transparent";
	var options = {
		div: 'map',
		maxResolution: "auto",
 		numZoomLevels: 2,
		maxExtent: new OpenLayers.Bounds(-25.67, 21.5, 51.55, 71.05),
		restrictedExtent: new OpenLayers.Bounds(-25.67, 21.5, 51.55, 71.05),

	};
	map = new OpenLayers.Map(options);
	
	var day= new OpenLayers.Layer.WMS("Day", "http://karlinapp.ethz.ch/cgi-bin/qgis_map_server/europa_diagram/qgis_mapserv.fcgi?", {layers: 'land_ocean_ice', styles: 'default', format: 'image/png', SRS: 'EPSG4258' },{tileSize: new OpenLayers.Size(512,512), buffer: 1 });
	var elev= new OpenLayers.Layer.WMS("Elevation", "http://demo.cubewerx.com/demo/cubeserv/cubeserv.cgi?CONFIG=main&", {layers: 'Foundation.Gtopo30', styles: 'default', format: 'image/png', SRS: 'EPSG4258' },{tileSize: new OpenLayers.Size(512,512), buffer: 1 });
	var polygons=addVectorLayer(map, "europe", 'shapefiles/europe_1', {
	style: { fillColor: '#ff8', fillOpacity: 0.5, strokeColor: '#f33', strokeWidth: 1.0, strokeOpacity: 1 } });
	map.addLayers([day,var,polygons]);

	var hilite = {
	selectStyle: { strokeColor: 'none', fillColor: '#fff', fillOpacity: 0.8 },
	};
    

	var layerswitch = new OpenLayers.Control.LayerSwitcher({'ascending':false}); 	
	map.addControl(layerswitch); 	
	map.addControl(new OpenLayers.Control.MousePosition());

	selectControl = new OpenLayers.Control.SelectFeature(polygons,
                {onSelect: onFeatureSelect, onUnselect: onFeatureUnselect});
				
				
	map.addControl(selectControl);

	selectControl.activate();
	
	layerswitch.maximizeControl();
	map.zoomToMaxExtent();
}	

</script>

</head>
<body onload="init()">
<div id="map" style="position:absolute;left:0;top:0;right:0;bottom:0"></div>
         
</body>
</html>
